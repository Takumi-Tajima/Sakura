- content_for :title, 'さくらマーケット'

.bg-light.py-5.mb-4
  .container.text-center
    %h1.h2.mb-3
      %i.bi.bi-flower1.me-2.text-primary
      さくらマーケット
    %p.lead 新鮮な生鮮食品をお届けします

.container.my-5
  - if user_signed_in? && current_user.current_cart.cart_items.any?
    .alert.alert-info.d-flex.justify-content-between.align-items-center
      %span
        %i.bi.bi-cart3.me-2
        カートに#{current_user.current_cart.total_quantity}個の商品があります
      = link_to 'カートを見る', cart_path, class: 'btn btn-primary btn-sm'

  %h2.h3.mb-4 商品一覧

  - if @products.any?
    .row
      - @products.each do |product|
        .col-md-6.col-lg-4.col-xl-3.mb-4
          .card.h-100.product-card
            - if product.image.attached?
              = image_tag product.image, class: 'card-img-top', 
                style: 'height: 200px; object-fit: cover;'
            - else
              .card-img-top.bg-light.d-flex.align-items-center.justify-content-center{style: 'height: 200px;'}
                %i.bi.bi-image.text-muted{style: 'font-size: 2rem;'}
            
            .card-body.d-flex.flex-column
              %h5.card-title= product.name
              %p.card-text.text-muted.flex-grow-1
                = truncate(product.description, length: 80)
              .d-flex.justify-content-between.align-items-center.mt-auto
                %h6.text-primary.mb-0
                  = number_to_currency(product.price, unit: '¥', delimiter: ',')
                = link_to '詳細', product_path(product), class: 'btn btn-outline-primary btn-sm'

  - else
    .text-center.py-5
      %p.text-muted 現在、販売中の商品はありません。

%style
  :css
    .product-card {
      transition: transform 0.2s ease-in-out;
    }
    .product-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    }
